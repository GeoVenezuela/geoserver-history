<?xml version="1.0" encoding="UTF-8"?>
<!-- 
  SiteSamplingStatistics mappings file
-->
<c:ComplexDataStore xmlns:c="http://www.geotools.org/complex" xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.geotools.org/complex ComplexDataStore.xsd
                      http://www.opengis.net/ogc http://schemas.opengis.net/filter/1.1.0/expr.xsd">
  <namespaces>
    <!-- 
      declare here the namespaces and prefixes used by the parser to
      resolve <type> elements. 
    -->

    <Namespace>
      <prefix>aw</prefix>
      <uri>http://www.water.gov.au/awdip</uri>
    </Namespace>
    <Namespace>
      <prefix>gmd</prefix>
      <uri>http://www.isotc211.org/2005/gmd</uri>
    </Namespace>
    <Namespace>
      <prefix>sa</prefix>
      <uri>http://www.opengis.net/sampling/1.0.0</uri>
    </Namespace>
    <!-- <Namespace>
      <prefix>geo</prefix>
      <uri>http://www.opengis.net/geomExt/0.0</uri>
      </Namespace>-->
    <Namespace>
      <prefix>xlink</prefix>
      <uri>http://www.w3.org/1999/xlink</uri>
    </Namespace>
    
    <Namespace>
      <prefix>swe</prefix>
      <uri>http://www.opengis.net/swe/1.0.1</uri>
    </Namespace>
    <Namespace>
      <prefix>cv</prefix>
      <uri>http://www.opengis.net/cv/0.2</uri>
    </Namespace>
    <Namespace>
      <prefix>om</prefix>
      <uri>http://www.opengis.net/om/1.0.0</uri>
    </Namespace>
    <Namespace>
      <prefix>gco</prefix>
      <uri>http://www.isotc211.org/2005/gco</uri>
    </Namespace>
    <Namespace>
      <prefix>gml</prefix>
      <uri>http://www.opengis.net/gml</uri>
    </Namespace>
  </namespaces>
  <sourceDataStores>
    <DataStore>
      <id>locations</id>
      <parameters>
        <Parameter>
          <name>directory</name>
          <value>file:./data/</value>
        </Parameter>
      </parameters>
    </DataStore>
  </sourceDataStores>
  <catalog>../../commonSchemas/OASIScatalog.xml</catalog>
  <targetTypes>
    <FeatureType>
      <!-- 
        Paths are relative to this file, or may be absolute URL's.
        Imports and includes at the schemas will be followed as long
        as they're relative paths.
      -->
      <schemaUri>../../commonSchemas/awdip.xsd</schemaUri>
    </FeatureType>
  </targetTypes>
  <typeMappings>
    <FeatureTypeMapping>
      <sourceDataStore>locations</sourceDataStore>
      <sourceType>locations</sourceType>
      <targetElement>aw:SiteSamplingStatistics</targetElement>
      <groupBy>
        <GroupByAttribute>station_id</GroupByAttribute>

      </groupBy>
      <attributeMappings>
        <AttributeMapping>
          <targetAttribute>aw:SiteSamplingStatistics</targetAttribute>
          <idExpression>
            <OCQL>station_id</OCQL>
          </idExpression>
        </AttributeMapping>

        <AttributeMapping>
          <targetAttribute>aw:SiteSamplingStatistics/aw:sampledPhenomenon</targetAttribute>
         
          <isMultiple>true</isMultiple>
        </AttributeMapping>
       
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:availableFrom</targetAttribute>
          <sourceExpression>
            <OCQL>mindatetime</OCQL>
          </sourceExpression>
        </AttributeMapping>
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:availableTo</targetAttribute>
          <sourceExpression>
            <OCQL>maxdatetime</OCQL>
          </sourceExpression>
        </AttributeMapping>
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:definition/aw:phenomenonDef/aw:name</targetAttribute>
          <sourceExpression>
            <OCQL>parmkey</OCQL>
          </sourceExpression>
        </AttributeMapping>
 
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:definition/aw:phenomenonDef/aw:baseDef/aw:phenomenonDef/aw:name</targetAttribute>
          <sourceExpression>
            <OCQL>parameter</OCQL>
          </sourceExpression>
        </AttributeMapping>
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:definition/aw:phenomenonDef/aw:title</targetAttribute>
          <sourceExpression>
            <OCQL>parname</OCQL>
          </sourceExpression>
        </AttributeMapping>
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:definition/aw:phenomenonDef/aw:timePeriod</targetAttribute>
          <sourceExpression>
            <OCQL>period</OCQL>
          </sourceExpression>
          <ClientProperty>
            <name>gml:codeSpace</name>
            <value>'http://escawri.org.au/parameters/timeperiod'</value>
          </ClientProperty>
        </AttributeMapping>
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:definition/aw:phenomenonDef/aw:timePeriodCount</targetAttribute>
          <sourceExpression>
            <OCQL>periodmult</OCQL>
          </sourceExpression>
        </AttributeMapping>
        <AttributeMapping>
          <targetAttribute>aw:sampledPhenomenon/aw:SummaryStatistics/aw:sampledPhenomenon/aw:phenomenonDef/aw:units</targetAttribute>
          <sourceExpression>
            <OCQL>units</OCQL>
          </sourceExpression>
        </AttributeMapping>

        <!--  rest is just repeat of basic SiteLocation -->
        <AttributeMapping>
          <targetAttribute>gml:name[1]</targetAttribute>
          <sourceExpression>
            <OCQL>station_id</OCQL>
          </sourceExpression>
          <ClientProperty>
            <name>gml:codeSpace</name>
            <value>'http://escawri.org.au/identifiers/public/samplingstations'</value>
          </ClientProperty>
        </AttributeMapping>

        <AttributeMapping>
          <targetAttribute>sa:sampledFeature</targetAttribute>
          <ClientProperty>
            <name>xlink:title</name>
            <value>stream</value>
          </ClientProperty>
          <ClientProperty>
            <name>xlink:href</name>
            <value>"urn:x-ogc:def:nil:OGC:unknown"</value>
          </ClientProperty>
        </AttributeMapping>

        <AttributeMapping>
          <targetAttribute>gml:description</targetAttribute>
          <sourceExpression>
            <OCQL>station_name</OCQL>
          </sourceExpression>
        </AttributeMapping>

        <AttributeMapping>
          <targetAttribute>aw:locationDesc</targetAttribute>
          <sourceExpression>
            <OCQL>location</OCQL>
          </sourceExpression>
        </AttributeMapping>

        <AttributeMapping>
          <targetAttribute>aw:samplingRegimeType</targetAttribute>
          <sourceExpression>
            <OCQL>'monitoring'</OCQL>
          </sourceExpression>
        </AttributeMapping>

        <!-- <AttributeMapping>
          <targetAttribute>SiteLocation/waterBodyType</targetAttribute>
          <sourceExpression>
            <OCQL>FEATURE_TYPE</OCQL>
          </sourceExpression>
        </AttributeMapping>
        
        <AttributeMapping>
          <targetAttribute>SiteLocation/accessTypeCode</targetAttribute>
          <sourceExpression>
            <OCQL>SITE_TYPE</OCQL>
          </sourceExpression>
        </AttributeMapping>-->

        <AttributeMapping>


          <targetAttribute>sa:position</targetAttribute>
          <sourceExpression>
            <OCQL>POSITION</OCQL>
          </sourceExpression>
        </AttributeMapping>
      </attributeMappings>
    </FeatureTypeMapping>
  </typeMappings>
</c:ComplexDataStore>
