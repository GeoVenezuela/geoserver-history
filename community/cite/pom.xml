<?xml version="1.0" encoding="ISO-8859-1"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  
  <modelVersion>4.0.0</modelVersion>

  <groupId>org.geoserver</groupId>
  <artifactId>cite</artifactId>
  <packaging>jar</packaging>
  <version>1.0</version>
  <name>Compliance + Interopability Testing + Evaluation (CITE) Module</name>

  <profiles>
    <profile>
      <id>wfs-1.0.0</id>
      <properties>
        <cite.service>wfs</cite.service>
        <cite.version>1.0.0</cite.version>
      </properties>
    </profile>
    <profile>
      <id>wfs-1.1.0</id>
      <properties>
        <cite.service>wfs</cite.service>
        <cite.version>1.1.0</cite.version>
      </properties>
    </profile>
    <profile>
      <id>wcs-1.0.0</id>
      <properties>
        <cite.service>wcs</cite.service>
        <cite.version>1.0.0</cite.version>
      </properties>
    </profile>
    <profile>
      <id>wms-1.1.1</id>
      <properties>
        <cite.service>wms</cite.service>
        <cite.version>1.1.1</cite.version>
      </properties>
    </profile>
  </profiles>
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <dependencies>
           <dependency>
              <groupId>sun.jdk</groupId>
              <artifactId>tools</artifactId>
              <version>1.5.0</version>
              <scope>system</scope>
              <systemPath>${java.home}/../lib/tools.jar</systemPath>
            </dependency>
        </dependencies>
        <executions>
          <execution>
             <id>pre</id>
             <phase>process-sources</phase>
             <configuration>
               <tasks> 
                  <!-- copy over env setup -->
                  <copy todir="${basedir}/engine/bin">
                    <fileset dir="${basedir}" includes="setenv.*"/> 
                  </copy>

                  <!-- copy over cite1 component -->
                  <delete dir="${basedir}/engine/components/cite1"/>
                  <copy todir="${basedir}/engine/components">
                     <fileset dir="${basedir}/tests/components" 
                         excludes="/**/.svn"/>
                  </copy>
                  <copy todir="${basedir}/engine/components/cite1"
                      file="${basedir}/build.properties"/>
 
                  <!-- copy over resources from test suite -->
                  <delete>
                    <fileset dir="${basedir}/engine/scripts" includes="**/*"/>
                  </delete>
                  <copy todir="${basedir}/engine/scripts/${cite.service}-${cite.version}">
                    <fileset dir="${basedir}/tests/${cite.service}/${cite.version}/ets" includes="resources/**/*"/>
                  </copy>
               </tasks> 
             </configuration>
             <goals>
                <goal>run</goal>
             </goals>
          </execution>
          <execution>
            <id>clean</id>
            <phase>clean</phase>
            <configuration>
              <tasks>
                <ant dir="${basedir}/engine" target="clean"/>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
          <execution>
            <id>compile</id>
            <phase>compile</phase>
            <configuration>
              <tasks>
                <property name="tomcat.dir" value="${basedir}/target"/>
                <mkdir dir="${basedir}/target/server/lib"/>
                <ant dir="${basedir}/engine" target="jar.engine"/>
                <ant dir="${basedir}/engine" target="jar.components"/>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

  <properties>
     <cite.service>wfs</cite.service>
     <cite.version>1.1.0</cite.version>
  </properties>
</project>
