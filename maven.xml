<!-- ========================= -->
<!-- GeoTools 2.0 build script -->
<!-- ========================= -->
<project xmlns:j="jelly:core" xmlns:u="jelly:util" xmlns:ant="jelly:ant" xmlns:maven="jelly:maven" xmlns:deploy="deploy" default="info">
	
	<goal name="info">

	</goal>

	<goal name="build">
		<j:set var="ignoreFailures" value="true"/>
		<j:set var="goal" value="clean,jar:install,test"/>
		<attainGoal name="multiproject:goal"/>
	</goal>

	<goal name="cleanAll">
		<!-- clean the root module -->
		<attainGoal name="clean"/>
		
		<!-- delete the geoserver deployment directory -->
		<ant:delete dir="geoserver"/>

		<!-- run multiproject clean -->
		<j:set var="ignoreFailures" value="true"/>
		<j:set var="goal" value="clean"/>
		<attainGoal name="multiproject:goal"/>
	</goal>

	<!-- multiproject goal to build + deploy war for each module -->
	<goal name="deployAll">
		<ant:mkdir dir="${maven.build.dir}/war"/>

		<j:set var="ignoreFailures" value="true"/>
		<j:set var="goal" value="deploy"/>
		<attainGoal name="multiproject:goal"/>

		<!--ant:unwar dest="${maven.build.dir}/war">
			<ant:fileset dir="." includes="**/*.war"/>
		</ant:unwar-->
		<ant:jar destfile="${maven.build.dir}/${pom.artifactId}.war"
			 basedir="${maven.build.dir}/war"/>
  </goal>

	<!-- module level goal to deploy a single module -->
	<goal name="deploy">
		<attainGoal name="war"/>
		<ant:unwar dest="${basedir}/../target/war">
			<ant:fileset dir="${maven.build.dir}" includes="*.war"/>
		</ant:unwar>
	</goal>

	<goal name="eclipseAll">
		<j:set var="ignoreFailures" value="true"/>
		<j:set var="goal" value="eclipse"/>
		<attainGoal name="multiproject:goal"/>
	</goal>

	<goal name="eclipseCleanAll">
		<j:set var="ignoreFailures" value="true"/>
		<j:set var="goal" value="eclipse:clean"/>
		<attainGoal name="multiproject:goal"/>
	</goal>

</project>
