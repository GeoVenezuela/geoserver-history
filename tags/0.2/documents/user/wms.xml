<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<article>
  <title>WMS Documentation</title>

  <sect1>
    <title>Introduction</title>

    <para>GeoServer version 1.1.0 introduces integrated support for Web Map
    Service. This should allow users to view their data both as GML (through
    the WFS) and as images (using the WMS). This is made possible by porting
    the GeoTools WMS into the GeoServer architecture. Configuring the
    DataStores through the web administration interface or in the
    <emphasis>catalog.xml</emphasis> file should make them available to both
    services.</para>

    <para>The WMS still needs some work, and we're hoping that various
    developers can devote some good time to it. Right now it can return
    GetCapabilities and GetMap, and we recently added GetFeatureInfo. We have
    not yet ported GetLegendGraphic from gt2wms. We hope to also add full SLD
    capabilities eventually, as geotools has a lot of solid SLD code. The
    other piece that has not yet ported is caching of features, which the WFS
    could also benefit from. GeoServer's architecture is a bit more complex,
    so there was no obvious place to put caching. It should return in a future
    version.</para>

    <para>As for features gained, the WMS now supports the Scalable Vector
    Graphics (SVG) image format (though no styling yet), in addition to the
    formats of the Geotools renderer (png, graymap, jpeg, jpeg2000, tiff,
    bitmap, and others). SVG is an XML-based language for web graphics, which
    has the potential to be more compact than other image formats. As it is
    xml it can also be fed to style sheets for complex presentation.</para>

    <para>We would love to hear your feedback on the WMS, bugs and problems
    you might have, as well as features that you would like to see added. The
    best way to report these is with our <ulink
    url="http://jira.codehaus.org/secure/BrowseProject.jspa?id=10311">tracker</ulink>.
    You will have to create an account to use it, but your email address will
    not be used except to notify you when your issue is worked on. If you are
    developer then adding more WMS capabilities is a great way to get involved
    in the GeoServer project. Soon we will have some better design documents,
    but until then just email geoserver-devel@lists.sourceforge.net and we can
    point you in the right directions.</para>

    <para>Note: In order to render images the java installation running the
    WMS needs to be installed with the Java Advanced Imaging and JAI Image I/O
    apis. The JAI can be downloaded <ulink
    url="http://java.sun.com/products/java-media/jai/downloads/download-1_1_2.html">here</ulink>
    and the Image I/O extension <ulink
    url="http://java.sun.com/products/java-media/jai/downloads/download-iio.html">here</ulink>.
    If they are not present then GeoServer will not advertise them in the
    capabilities document.</para>
  </sect1>

  <sect1>
    <title>Configuration</title>

    <para>Most of the WMS configuration is the same as that specified in the
    <ulink url="install.htm">installation</ulink> document. The web interface
    can be used to configure the WMS, but styles are still a bit buggy, so it
    may be best to just stick with the files. Either way the styles will need
    to be added to the styles directory. The <emphasis>services.xml</emphasis>
    file will have an additional section that mirrors the WFS service
    type:<programlisting>&lt;services&gt;
  &lt;service type="WMS" enabled="true"&gt;
    &lt;name&gt;GeoServer WMS&lt;/name&gt;
    &lt;title&gt;The TOPP Basemap Server&lt;/title&gt;
    &lt;abstract&gt;This is a test server. It contains some basemap data from New York City.&lt;/abstract&gt;
    &lt;keywords&gt;&lt;keyword&gt;New York&lt;/keyword&gt;&lt;keyword&gt;transportation&lt;/keyword&gt;&lt;/keywords&gt;
    &lt;onlineResource&gt;http://www.openplans.org&lt;/onlineResource&gt;  
    &lt;maintainer&gt;The Open Planning Project&lt;/maintainer&gt;
  &lt;/service
&lt;/services&gt;</programlisting></para>

    <para>All the tags are for the Service section of the Capabilities
    document, so they can be the same or different from the WFS ones.</para>

    <para>The <emphasis>catalog.xml</emphasis> file is mostly the same, all
    datastores defined are available for both WMS and WFS. The one difference
    is the addition of the styles section: <programlisting> &lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;catalog&gt;
  &lt;!-- defines the datastores, more than one is possible --&gt;
  &lt;datastores&gt;
     ...
  &lt;/datastores&gt;

  &lt;styles&gt;
    &lt;style id="green" filename="green.sld"/&gt;
    &lt;style id="blue" filename="blue.sld"/&gt;
    &lt;style id="normal" filename="normal.sld"/&gt;
  &lt;/styles&gt;
&lt;/catalog&gt;</programlisting></para>

    <para>Each id will be the name of the style in a client request. Each
    filename must be found in the <emphasis>data/styles</emphasis> directory
    (if working with the war, if working from source then in conf/styles/),
    which is copied to the webapp in the data/styles directory. Styles still
    need some work, as all styles can be requested for all featureTypes, even
    if they don't apply. The included green style should work for all
    polygons, and the blue style should work for all linestrings. In the
    future GeoServer hopes to have each featureType be able to figure out
    which styles apply to it, and only return those styles. Right now it will
    fail in the renderer if the style can not be applied</para>
  </sect1>

  <sect1>
    <title>Testing</title>

    <para>The WMS has not yet been tested with many clients, we would love to
    hear reports of success. But a standard web browser should be able to
    return results. To see the WMS capabilities document issue the following
    request to any web browser.</para>

    <para><emphasis>http://<emphasis
    role="bold">SERVER_ADDRESS</emphasis>:<emphasis
    role="bold">SERVER_PORT</emphasis>/geoserver/wms?request=GetCapabilities</emphasis></para>

    <para>Note that <emphasis role="bold">SERVER_ADDRESS</emphasis> and
    <emphasis role="bold">SERVER_PORT</emphasis> should be replaced by your
    server's address and port (localhost:8080 will suffice for the default of
    tomcat or resin running on your local machine). The default GeoServer
    installation should have a bc_roads featureType by default. To get a map
    of this feature issue the request:</para>

    <para><emphasis>http://localhost:8080/geoserver/wms?request=GetMap&amp;layers=bc_roads&amp;bbox=489153,5433000,
    529000,5460816&amp;width=400&amp;height=200&amp;srs=EPSG:27354&amp;styles=normal&amp;Format=image/png</emphasis></para>

    <para>It should also work with the 'blue' style - just do
    <emphasis>styles=blue</emphasis> instead of
    <emphasis>styles=normal</emphasis>. Other formats are also available,
    check the capabilities document. For SVG just issue
    <emphasis>Format=image/svg</emphasis>. Note that these urls are also
    available in the web interface, on the demo page.</para>
  </sect1>
</article>